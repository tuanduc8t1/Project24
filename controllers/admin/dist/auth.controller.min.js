"use strict";var md5=require("md5"),Account=require("../../models/account.model"),systemConfig=require("../../config/system");module.exports.login=function(e,r){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:r.render("admin/pages/auth/login",{pageTitle:"Đăng nhập"});case 1:case"end":return e.stop()}})},module.exports.loginPost=function(r,t){var n,a,o;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.body.email,a=r.body.password,e.next=4,regeneratorRuntime.awrap(Account.findOne({email:n,deleted:!1}));case 4:if(o=e.sent){e.next=9;break}return r.flash("error","Email không tồn tại!"),t.redirect("back"),e.abrupt("return");case 9:if(md5(a)!=o.password)return r.flash("error","Sai mật khẩu!"),t.redirect("back"),e.abrupt("return");e.next=13;break;case 13:if("active"!=o.status)return r.flash("error","Tài khoản đang bị khóa!"),t.redirect("back"),e.abrupt("return");e.next=17;break;case 17:t.cookie("token",o.token),t.redirect("/".concat(systemConfig.prefixAdmin,"/dashboard"));case 19:case"end":return e.stop()}})},module.exports.logout=function(e,r){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:r.clearCookie("token"),r.redirect("/".concat(systemConfig.prefixAdmin,"/auth/login"));case 2:case"end":return e.stop()}})};
//# sourceMappingURL=auth.controller.min.js.map
